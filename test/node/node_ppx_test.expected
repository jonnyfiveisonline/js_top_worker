=== Node.js PPX Tests ===

node_ppx_test.js: [INFO] init()
Initializing findlib
Parsed uri: lib/stdlib-shims/META
Reading library: stdlib-shims
Number of children: 0
Parsed uri: lib/sexplib0/META
Reading library: sexplib0
Number of children: 0
Parsed uri: lib/ppxlib/META
Reading library: ppxlib
Number of children: 11
Found child: __private__
Reading library: ppxlib.__private__
Number of children: 1
Found child: ppx_foo_deriver
Reading library: ppxlib.__private__.ppx_foo_deriver
Number of children: 0
Found child: ast
Reading library: ppxlib.ast
Number of children: 0
Found child: astlib
Reading library: ppxlib.astlib
Number of children: 0
Found child: metaquot
Reading library: ppxlib.metaquot
Number of children: 0
Found child: metaquot_lifters
Reading library: ppxlib.metaquot_lifters
Number of children: 0
Found child: print_diff
Reading library: ppxlib.print_diff
Number of children: 0
Found child: runner
Reading library: ppxlib.runner
Number of children: 0
Found child: runner_as_ppx
Reading library: ppxlib.runner_as_ppx
Number of children: 0
Found child: stdppx
Reading library: ppxlib.stdppx
Number of children: 0
Found child: traverse
Reading library: ppxlib.traverse
Number of children: 0
Found child: traverse_builtins
Reading library: ppxlib.traverse_builtins
Number of children: 0
Parsed uri: lib/ppx_deriving/META
Reading library: ppx_deriving
Number of children: 12
Found child: api
Reading library: ppx_deriving.api
Number of children: 0
Found child: create
Reading library: ppx_deriving.create
Number of children: 0
Found child: enum
Reading library: ppx_deriving.enum
Number of children: 0
Found child: eq
Reading library: ppx_deriving.eq
Number of children: 0
Found child: fold
Reading library: ppx_deriving.fold
Number of children: 0
Found child: iter
Reading library: ppx_deriving.iter
Number of children: 0
Found child: make
Reading library: ppx_deriving.make
Number of children: 0
Found child: map
Reading library: ppx_deriving.map
Number of children: 0
Found child: ord
Reading library: ppx_deriving.ord
Number of children: 0
Found child: runtime
Reading library: ppx_deriving.runtime
Number of children: 0
Found child: show
Reading library: ppx_deriving.show
Number of children: 0
Found child: std
Reading library: ppx_deriving.std
Number of children: 0
Parsed uri: lib/ppx_derivers/META
Reading library: ppx_derivers
Number of children: 0
Parsed uri: lib/ocaml_intrinsics_kernel/META
Reading library: ocaml_intrinsics_kernel
Number of children: 0
Parsed uri: lib/ocaml/stdlib/META
Reading library: stdlib
Number of children: 0
Parsed uri: lib/ocaml/compiler-libs/META
Reading library: compiler-libs
Number of children: 5
Found child: common
Reading library: compiler-libs.common
Number of children: 0
Found child: bytecomp
Reading library: compiler-libs.bytecomp
Number of children: 0
Found child: optcomp
Reading library: compiler-libs.optcomp
Number of children: 0
Found child: toplevel
Reading library: compiler-libs.toplevel
Number of children: 0
Found child: native-toplevel
Reading library: compiler-libs.native-toplevel
Number of children: 0
Parsed uri: lib/ocaml-compiler-libs/META
Reading library: ocaml-compiler-libs
Number of children: 5
Found child: bytecomp
Reading library: ocaml-compiler-libs.bytecomp
Number of children: 0
Found child: common
Reading library: ocaml-compiler-libs.common
Number of children: 0
Found child: optcomp
Reading library: ocaml-compiler-libs.optcomp
Number of children: 0
Found child: shadow
Reading library: ocaml-compiler-libs.shadow
Number of children: 0
Found child: toplevel
Reading library: ocaml-compiler-libs.toplevel
Number of children: 0
Parsed uri: lib/base/META
Reading library: base
Number of children: 3
Found child: base_internalhash_types
Reading library: base.base_internalhash_types
Number of children: 0
Found child: md5
Reading library: base.md5
Number of children: 0
Found child: shadow_stdlib
Reading library: base.shadow_stdlib
Number of children: 0
node_ppx_test.js: [INFO] Adding toplevel modules for dynamic cmis from lib/ocaml/
node_ppx_test.js: [INFO]   toplevel modules: CamlinternalFormat, CamlinternalLazy, CamlinternalFormatBasics, CamlinternalMod, Std_exit, Stdlib, CamlinternalOO
node_ppx_test.js: [INFO] init() finished
node_ppx_test.js: [INFO] setup() for env default...
node_ppx_test.js: [INFO] Fetching stdlib__Format.cmi

node_ppx_test.js: [INFO] Fetching stdlib__Sys.cmi

error while evaluating #enable "pretty";;
error while evaluating #disable "shortvar";;
node_ppx_test.js: [INFO] Setup complete
node_ppx_test.js: [INFO] setup() finished for env default
--- Loading PPX dynamically ---
node_ppx_test.js: [INFO] Custom #require: loading ppx_deriving.show
Loading package ppx_deriving.show
lib.dir: show
Loading package ppx_deriving.runtime
lib.dir: runtime
uri: lib/ppx_deriving/runtime/dynamic_cmis.json
importScripts: lib/ppx_deriving/runtime/ppx_deriving_runtime.cma.js
Finished loading package ppx_deriving.runtime
Loading package ppx_deriving
lib.dir: None
uri: lib/ppx_deriving/dynamic_cmis.json
Failed to unmarshal dynamic_cms from url lib/ppx_deriving/dynamic_cmis.json: Failed to fetch dynamic cmis
uri: lib/ppx_deriving/show/dynamic_cmis.json
importScripts: lib/ppx_deriving/show/ppx_deriving_show.cma.js
Finished loading package ppx_deriving.show
node_ppx_test.js: [INFO] Adding toplevel modules for dynamic cmis from lib/ppx_deriving/show/
node_ppx_test.js: [INFO]   toplevel modules: Ppx_deriving_show
node_ppx_test.js: [INFO] Adding toplevel modules for dynamic cmis from lib/ppx_deriving/runtime/
node_ppx_test.js: [INFO]   toplevel modules: Ppx_deriving_runtime
node_ppx_test.js: [INFO] Custom #require: ppx_deriving.show loaded
[PASS] load_ppx_show: ppx_deriving.show loaded
node_ppx_test.js: [INFO] Custom #require: loading ppx_deriving.eq
Loading package ppx_deriving.eq
lib.dir: eq
Loading package ppx_deriving
lib.dir: None
uri: lib/ppx_deriving/dynamic_cmis.json
Failed to unmarshal dynamic_cms from url lib/ppx_deriving/dynamic_cmis.json: Failed to fetch dynamic cmis
uri: lib/ppx_deriving/eq/dynamic_cmis.json
importScripts: lib/ppx_deriving/eq/ppx_deriving_eq.cma.js
Finished loading package ppx_deriving.eq
node_ppx_test.js: [INFO] Adding toplevel modules for dynamic cmis from lib/ppx_deriving/eq/
node_ppx_test.js: [INFO]   toplevel modules: Ppx_deriving_eq
node_ppx_test.js: [INFO] Custom #require: ppx_deriving.eq loaded
[PASS] load_ppx_eq: ppx_deriving.eq loaded

--- Section 1: ppx_deriving.show ---
[PASS] show_type_defined: type color defined
[PASS] show_pp_generated: pp_color generated
[PASS] show_fn_generated: show_color generated
[PASS] show_fn_works: # show_color Red;;
  - : Ppx_deriving_runtime.string = "Red"
[PASS] show_record_type: point type defined
[PASS] show_record_pp: pp_point generated
[PASS] show_record_works: # show_point { x = 10; y = 20 };;
  - : Ppx_deriving_runtime

--- Section 2: ppx_deriving.eq ---
[PASS] eq_type_defined: status type defined
[PASS] eq_fn_generated: equal_status generated
[PASS] eq_same_true: # equal_status Active Active;;
  - : Ppx_deriving_runtime.bool = true
[PASS] eq_diff_false: # equal_status Active Inactive;;
  - : Ppx_deriving_runtime.bool = false

--- Section 3: Combined Derivers ---
[PASS] combined_type: expr type defined
[PASS] combined_pp: pp_expr generated
[PASS] combined_eq: equal_expr generated
[PASS] combined_value: # let e1 = Add (Num 1, Num 2);;
  val e1 : expr = Add (Num 1, Num 2)
[PASS] combined_show_works: # show_expr e1;;
  - : Ppx_deriving_runtime.string = "(Add ((Num 1), (Num 2)))"
[PASS] combined_eq_self: # equal_expr e1 e1;;
  - : Ppx_deriving_runtime.bool = true
[PASS] combined_eq_diff: # equal_expr e1 (Num 1);;
  - : Ppx_deriving_runtime.bool = false

--- Section 4: Basic Code Still Works ---
[PASS] basic_arithmetic: # let x = 1 + 2;;
  val x : int = 3
[PASS] recursive_fn: # let rec fib n = if n <= 1 then n else fib (n-1) + fib (n-2);;
  val fib : int -> int = <fun>
[PASS] fib_result: # fib 10;;
  - : int = 55

--- Section 5: Module Support ---
[PASS] module_with_deriving: # module M = struct type t = A | B [@@deriving show] end;;
  module M :
    sig
      type t = A | B
      val pp :
        Ppx_deriving_runtime.Format.formatter -> t -> Ppx_deriving_runtime.unit
      val show : t -> Ppx_deriving_runtime.string
    end
Line 1, characters 0-8:
Error: Unbound value M.show_t
Hint:   Did you mean M.show?
[PASS] module_show_works: # M.show_t M.A;;

=== Results: 25/25 tests passed ===
SUCCESS: All PPX tests passed!
